_z_ht = "5d0000000210c400000000000000673e99afde623b5ce29095bcfd3fb0ad199f108e5ae4e9d74b975d498bf0fabb9d02047564d2dc9609b04ad3e0427fe4aa4e0dd9cf7614f7a1d4a8e44967b8fc63b8ac8aba5040587c957662e0721497e47c95bad3787aab10bb6ae95255e8f6801ef99907fd362ac66a0b1fee1292b2ebd3b7af32a345bd1b831e1928fed5180b82309e898d6e108e6f3723a7389a126559cfc47c6a53238fb24395d7de87ba9461e036fc87801a71a08dbf9316be853d4c9a38ce3b8124d6b8b8a9671500b77778e8c5efdd8e0763a67f090e8ec26fe45812ba934d63916dad03652387bd0148957848e8db171f8f2a477abe476a4072b19cdaf0d08eec04844a96ea2c8cd1daa63614ebf2d6d3e6497904485bb44e60b1ce98e3824583a068931b87436e902c2cf5d3cc9ed4849c1c65b863491e33334240bd05c86c64d37a78974d31d863351b02e7bb2eada596ea9ef6d68a0f188bb636b844a1f6701aa2dad7bdd8329bb6e345fd36d9b053e568c8307c0032dfd71306b371b8033e66737fc22f335f5ee2eaefc5fe8c9ebba49c055913d064e088f57307a7a66bb07b105a14573a2c6c7e012a0dfcf3dfbe3f8b36db2a7077078c4c00d483bf383f6df7d9f930fb57112fc87a2cc420bb7078000d4bd8de778851c37329e90cdd3ed275fe4ac5bc3672b348b20b78dde457ec5731261592f4758bf9b7fc6a34dfa6b6ef1363fe5c6c6a06486e5ec1a87979613f80c0c1985899f3fd3d124273637599d3d73ea25e7318f0a16e11c2ab16b561e252abbb9a39e4146d8302e9ddc9b76c366315f6e264dbbac3313ab268934c02258299f390aad1d8ab6e85b5bca71fc6adae4972bac1767ddd63f645189979f0938f40b309d26dc9552b5ebe2c0f95d45673863f5148d2d76139c1f00d41d35e3ae3c8fe2bf85827ccb3736b55961b97a3259f4abb391bfa4c7118e6cd2eeb35a04272069181945e1f0124a269063ad7576d7ac59993e71a4a25dded618fd36525d1500c0c36477c7d0d385069d508cfdc1e65d0e8a2b9598e9cabfba68a23dbcb4b26accfc24eafb33a8f66006a12aef7e5445e568b8eb26b44ae692607d8c93ecf6dce6c7be4d53e7a9ac7ee5318ff231c985e535314954a589661b2ccab167d6207923e5ffa220486b6bac7d7acb0cd994f19cee2f842adf9a4fe687476d2fd5fe96a89d198894486a098d4545ceb85ddd46a7119eadc86baff51702135ce96cd8cb48b14c67e1ab138c9e49bada3afd776d233da8a42f01101ffa497611c2c0e0544f8575f39c286df0c6f1ea624382dbbec9c03fa22245444fd59ee451f514421aa61e215c36dff82be87930e608a35037b32d9e52a2893a0b6843b0ddd66095069fbba3727e29ef46d244833bbc02dc7853c8a5e311952c4fc8b99f2570b9100d937fed725b79dd179831fc92f4b59849f46cf447a65e4fd8271f19fa21128409205b0ef87baab553e9e02cad29813d1c0fe28f19f922799ca0a25c5682f28ea4a9d0be0302b5cb9ab5dd22497a570c4210f91eb516b96a7be745303051155a5cc18339e3aa6eafa81ec9891254178229afd4d143fa050957bcfedd4aa3d976725bff53f74a6a66c533762119fa52a35441c0fe22f52a12033ab3a70fdd479ed18958d12cb9d79b4172e629e03331db01007d66f424d6a6063f503c3a19d970577a60642442400bd0df36e0bf75ad49b6d0c14966d20f185ef0825d6d855168d1681cca5f781b944c53c37058df0a7ef04ad8207fdc06d88f008096e3d96473470b80df19ec35bb47a1d7df3cd1c59392f4d53b85e16b458509194f96c5c1a08cb3b57dcc99d7284045fcc1ba02b1986a8e8db1d435a1624a1a323cc0d2f979d98f2409a94f07bde101f6cfcf51db796998e823d2dbc48a82ad171bb01360b5870b6c5775f23b908bcb029bf8b6de0c8e65d44cbb44ef2b28bc6e5fefa4a364385c0edf8ba0d074ef0ec4563b1d8e3fedcca6e3078442cf614a9e20dc4abeae61026b26b3a470bfd2f08ce5785cae7283c3182fbd7facf3d49dab3b3d96130ba30d10c7f61a6f81d78c9b3da6600bb028db3f5de6bf40d964d9d913d594ec46f42229577d3fd612c8220fe213330873a29abd6e62f1d36a1df5f470296e0efd9dc4893546c3ecf9ed506b16dba759674299bead474069499b9454cd72b54e6fb5db0c72689056826e2bd94fb8216838a2515977edeeefc6dd321d1d89dda77a2d96d5ebdb3c067ac21d8b1f8f9e06323db93e8a50321d1c896915cd2d4df88537c20c91baa7bac83cf7022e29e672289d3f7dd4c0a532275f11c0a8a282c8c587d0a464afdae4fe041f412deb1f934877717f5936f47ef6b350877d0081092278feced372ffc2ab6f922d955da803b417b0ab46ab0593703a64d37599dbec6271adc53cd0f67e0bbe0bf4427b1eb5675e03e4f0f4e9e357317de7babfea7700527360cd35e561ffc06afe86fb006a34dc03bcd845835920c4ab55825c202d73a75cb060b9cbf0b32c82118b95c5bd6ca795c2a958a69b9d93dfdbbafd32e1f323f7b63599e9a1cc37585fa031085f317fc8e5050b5a61ec993d6d34eb4fe24524d3ae6ca9eee057984650e28c94bae1d7790efc838209482756bb68e394a0290dcc9fe41ec32882dd01bcadea409cbdd814abc55f8f27d1f55e9e75e09b879a640af724b91995c53fc8c1e2b10c88f5bb0ae03475469a2c400"
(function(s)load((string.gsub((string.gsub(s,"O(..-[o].)",function(s)local n,c=string.match(s,"(..-)o(.)") s="" for i=1,n do s=s..c end return s end)),"(%x%x)[ ]?",function(w)return string.char(tonumber(w,16))end)))()end)("1b4c7561520001040404080019930d0a1a0aO19o010408O7o01O6o0414O5o0a5O7o08800081a54O5o0cO6o01dd4080001f008O4o03O7o042dO6o02f7661722f6d6f62696c652f4d656469612f546f7563685370726974652f7265732f736f7a65746f6f6c732f00040cO6o07a5f545346756e634c6962000407O6o07a5f6874747O4o02O7o04O6o019O7o03000f48O6o0c1O7o06414O4o0781400241c1O4o085018000568181021d4100010601410007414102450180008001800156818102818101001d8180011b41O4o0178001806501O4o086c14100c5018O6o028001d60182035d418001174000804c0142025d4100015c41000117800080464140004741c2025d8180008c81c20001c20200410203009d8100024O6o038641400087814003c5018O6o028001414203008002O4o0c18203O5o03800041c3030080038002d68183039d4100018601410087414103c0018002018201009d818001cc01440341420400dd8180010c0242031d42000106424O4o078240044182040085028000c002800156c282041d4200019b4O5o017c0008006424O4o07c24404400280021d420001df0100011f00800014O7o0407O6o07a5f6874747O4o0403O6o06f73000408O6o06578656375746500040aO6o06d6b646972202d702O4o0403O6o0696f000405O6o06f70656e000402O6o072000406O6o05f7a5f6874000406O6o0636c6f7365000408O6o0746d706e616d65000405O6o067737562000404O6o05b245d000403O6o05c24000402O6o02O4o0403O6o02022000403O6o0222O4o0405O6o072656164000405O6o02a616c6c000404O6o0726d2O4o0407O6o072656d6f76650001O7o09O7o09O7o02000923O6o08600400087404001c0008O4o0181O4o09d808001ccc040016501O4o08001O4o05d010001dd4O5o0cc004101dd4O4o01c6404100c780c10101c101004001800081010200c0018O4o0142020016010202dd4O4o01c6404100c780c10101810200400180008141020016810102dd4O4o01c6404100c780c10101c102004001800016410102dd4O4o011f008O4o0cO7o0403O6o0696f000405O6o06f70656e000402O6o077000406O6o07772697465000406O6o0636c6f7365000403O6o06f73000408O6o065786563757465000404O6o06d762O4o0402O6o02O4o0406O6o02e6c7a6d61000409O6o06c7a6d61202d642O4o040bO6o063686d6f64203737372O4o01O7o09O7o09O7o01000506O6o04c004000c14O5o02501O4o05d8O4o025fO5o011f008O4o02O7o0405O6o06773756200040bO6o02825782578295b205d3f0001O7o09O7o09O7o01000509O6o0460040004740c00086804000cO8o01c1O4o09d0080015eO6o05fO6o01f008O4o04O7o0407O6o0737472696e67000405O6o063686172000409O6o0746f6e756d6265720003O12o0304O10o01O10o034O6o0405c5c7073665c486f6d655c4465736b746f705c5453466f6c6465725ccedeb2e5bcfec1aacdf8cfc2d4d844554d502e6c75610009O7o09O7o09O7o09O7o09O7o09O7o09O7o09O7o09O7o09O7o01O7o02O6o077O11o09O7o01O7o05O6o05f454e560001O10o034O6o0405c5c7073665c486f6d655c4465736b746f705c5453466f6c6465725ccedeb2e5bcfec1aacdf8cfc2d4d844554d502e6c75610006O7o09O7o09O7o09O7o09O7o09O7o09O7o02O7o02O6o068O11o06O7o02O6o0730004O7o06O7o01O7o05O6o05f454e560001O10o034O6o0405c5c7073665c486f6d655c4465736b746f705c5453466f6c6465725ccedeb2e5bcfec1aacdf8cfc2d4d844554d502e6c75610023O7o09O7o09O7o09O7o09O7o09O7o09O7o09O7o09O7o09O7o09O7o09O7o09O7o09O7o09O7o09O7o09O7o09O7o09O7o09O7o09O7o09O7o09O7o09O7o09O7o09O7o09O7o09O7o09O7o09O7o09O7o09O7o09O7o09O7o09O7o09O7o03O7o02O6o073O10o023O7o03O6o0666eO10o023O7o02O6o0660005O6o023O7o01O7o05O6o05f454e560002O11o010034O6o0405c5c7073665c486f6d655c4465736b746f705c5453466f6c6465725ccedeb2e5bcfec1aacdf8cfc2d4d844554d502e6c75610048O7o05O7o06O7o06O7o06O7o06O7o06O7o06O7o07O7o07O7o07O7o07O7o07O7o07O7o07O7o08O7o08O7o09O7o09O7o09O7o09O7o09O7o09O7o09O7o0bO7o0bO7o0dO7o0dO7o0dO7o0dO7o0dO7o0fO7o0fO7o0fO7o0fO7o0fO6o01O7o01O7o01O7o01O7o01O7o01O7o01O7o01O7o01O7o01O7o01O7o01O7o011O6o011O6o011O6o011O6o011O6o012O6o012O6o012O6o013O6o013O6o014O6o014O6o014O6o014O6o014O6o014O6o014O6o015O6o015O6o016O6o016O6o016O6o016O6o018O6o019O7o08O7o04O6o0676f7O11o048O7o04O6o075726cO10o048O7o03O6o06669O10o048O7o03O6o0686e0001O6o048O7o02O6o066000eO6o048O7o03O6o0666e001eO6o048O7o02O6o0660034O6o048O7o02O6o0720037O6o048O7o02O7o05O6o05f454e560003O6o07464001bO6o036O11o0831O7o04O6o065O6o0a54O5o0c6004000c740c00105010001450180008181O4o01681010241c1O4o0dd808001db4O5o01780028O4o018000410101001d810001O7o025840410017400080068141001d418O6o0100011d418000174000800cc1c1011d410001060142004501000185018000c181O4o056c181021d410001064142001d8180001980420217c0028O4o01800041c102001d810001O7o025840410017400080068141001d418O6o0100011d418O4o050180011d4180001f008O4o0cO7o0403O6o0696f000405O6o06f70656e000405O6o02e6c7561000402O6o072000407O6o0e4b88be8bdbd0003O17o0409O6o06c75615f65786974000406O6o0636c6f7365000407O6o0646f66696c6500040dO6o07a5f6c696256657273696f6e00032b8716d9cef7f33f0407O6o0e69bb4e696bO4o02O6o01dO6o01fO7o0100091O7o046004000814O5o0cO8o0181O4o04501800081c1O4o0c001O5o0102010096000201cO8o0141010041810100818101005eO5o035fO6o01f008O4o07O7o040aO6o06469616c6f67526574000416O6o0e8849ae69cace99c80e8a681e4bb8ee7bd91e7bb9c00040eO6o0e4b880e4b8aae68f92e4bbb62800044fO6o02e6c756129e6898de883bde7bba7e7bbad0ae8bf99e99c80e8a681e6b688e88097e4b880e4ba9be7bd91e7bb9ce6b581e9878f283c3130306b42290ae698afe590a6e99c80e8a681e7ab8be58db3000404O6o0efbc9f000407O6o0e58f96e6b6880003O25o02O13o0134O6o0405c5c7073665c486f6d655c4465736b746f705c5453466f6c6465725ccedeb2e5bcfec1aacdf8cfc2d4d844554d502e6c7561001O7o01eO6o01eO6o01eO6o01eO6o01eO6o01eO6o01eO6o01eO6o01eO6o01eO6o01eO6o01eO6o01eO6o01eO6o01eO6o01fO7o01O7o04O6o0646f75O10o01O8o02O7o05O6o05f454e560003O6o0706e002O7o022O11o060cO7o06004000414O5o0818O5o0c5008O4o01c1O4o096000101c5O5o010501800041010100d64081011d4O4o021f008O4o05O7o0407O6o07a5f6874747O4o0404O6o067657400042O7o0687474703a2f2f6263732e64756170702e636f6d2f736372697074696f6e2f00040aO6o02e6c75612e636f6d7O4o0405O6o02e6c7561O11o03O13o01000234O6o0405c5c7073665c486f6d655c4465736b746f705c5453466f6c6465725ccedeb2e5bcfec1aacdf8cfc2d4d844554d502e6c7561000cO6o021O6o021O6o021O6o021O6o021O6o021O6o021O6o021O6o021O6o021O6o021O6o022O15o03O7o05O6o05f454e560003O6o0706e0003O6o074640004O11o01010100010234O6o0405c5c7073665c486f6d655c4465736b746f705c5453466f6c6465725ccedeb2e5bcfec1aacdf8cfc2d4d844554d502e6c75610031O6o01cO6o01fO6o022O6o023O6o023O6o023O6o023O6o023O6o023O6o023O6o023O6o024O6o024O6o025O6o025O6o025O6o025O6o026O6o026O6o027O6o027O6o029O6o029O6o029O6o02bO6o02bO6o02dO6o02dO6o02dO6o02dO6o02dO6o02dO6o02eO6o02eO6o02eO6o02eO6o02fO6o02fO6o02fO6o02fO6o03O7o03O7o031O6o031O6o033O6o033O6o034O6o034O6o036O7o04O7o02O6o0630001O6o031O7o03O6o064720002O6o031O7o03O6o0677O4o03O6o031O7o02O6o066000bO6o031O7o04O7o05O6o05f454e560003O6o0706e0003O6o07464000aO6o0646f776e636865636b0001O7o010034O6o0405c5c7073665c486f6d655c4465736b746f705c5453466f6c6465725ccedeb2e5bcfec1aacdf8cfc2d4d844554d502e6c75610008O7o01O7o02O6o019O7o04O6o036O6o038O6o038O6o038O7o03O7o03O6o074640001O7o08O7o03O6o0706e0002O7o08O7o0aO6o0646f776e636865636b0005O7o08O7o01O7o05O6o05f454e5600")

function mkcode(code)
    local sum = 0
    local len = string.len(code)
    for i = 1, len, 1 do
        sum = sum + (string.byte(code, i) % 16) ^ ((i - 1) % 7);
    end
    return(sum);
end

function json2table(json)
    local j = string.gsub(json, '\"([^\"]-)\":', '%1=')
    local j = string.gsub(j, '%b\\[\\]', '')
    local j = string.gsub(j, '\\', '\\\\')
    local j = 't='..j
    loadstring = loadstring or load
    loadstring(j)()
    return t
end

function digit_to(n,s)
    local fl = math.floor
    local i = 0
    while 1 do
        if n>(#s)^i then
            i = i + 1
        else
            break
        end
    end
    local ret = ""
    while i>=0 do
        if n>=(#s)^i then
            local tmp = fl(n/(#s)^i)
            n = n - tmp*(#s)^i
            ret = ret..s:sub(tmp+1, tmp+1)
        else
            if ret~="" then
                ret = ret..s:sub(1, 1)
            end
        end
        i = i - 1
    end
    return ret
end

function to_digit(ns,s)
    local ret = 0
    for i=1,#ns do
        local fd = s:find(ns:sub(i,i))
        if not fd then
            return nil
        end
        fd = fd - 1
        ret = ret + fd*((#s)^((#ns)-i))
    end
    return ret
end

function encodeURI(s)
    s = string.gsub(s, "([^%w%.%- ])", function(c) return string.format("%%%02X", string.byte(c)) end)
    return string.gsub(s, " ", "+")
end

function utf8decode(us)
    local u16p = {
        0xdc00,
        0xd800,
    }
    local u16b = 0x3ff
    local u16fx = ""
    local padl = {
        ["0"] = 7,
        ["1"] = 11,
        ["11"] = 16,
        ["111"] = 21,
    }
    local padm = {}
    for k,v in pairs(padl) do
        padm[v] = k
    end
    local map = {7,11,16,21}
    return (string.gsub(us, "\\[Uu](%x%x%x%x)", function(uc)
        local ud = tonumber(uc,16)
        for i,v in ipairs(u16p) do
            if ud>=v and ud<(v+u16b) then
                ud = ud - v + (i-1) * 0x40
                if (i-1)>0 then
                    u16fx = digit_to(ud, "01")
                    return ""
                end
                local bi = digit_to(ud, "01")
                uc = string.format("%x", to_digit(u16fx..string.rep("0",10-#bi)..bi,"01"))
                u16fx = ""
                ud = tonumber(uc,16)
                break
            end
        end
        local bins = digit_to(ud,"01")
        local pads = ""
        for _,i in ipairs(map) do
            if #bins<=i then
                pads = padm[i]
                break
            end
        end
        while #bins<padl[pads] do
            bins = "0"..bins
        end
        local tmp = ""
        if pads~="0" then
            tmp = bins
            bins = ""
        end
        while #tmp>0 do
            bins = "10"..tmp:sub(-6, -1)..bins
            tmp = tmp:sub(1, -7)
        end
        return (string.gsub(string.format("%x", to_digit(pads..bins, "01")), "(%x%x)", function(w)
            return string.char(tonumber(w,16))
        end))
    end))
end

function m_initRandom(d)
	for j=1,#d-12 do
		math.randomseed(tonumber(d:sub(j,j+5),16)+os.time()+os.clock()*1000)
		for i=1,10 do
			math.random(0,tonumber(d:sub(j+6,j+11),16))
			--mSleep(30+math.random(0,10))
		end
		math.randomseed(math.random(0,tonumber(d:sub(j+6,j+11),16))+os.time()+os.clock()*1000)
	end
end

function string:random(len)
	-- math.randomseed(math.floor((os.time()+os.clock()*1000)))
	-- for i=1,10 do
	--     math.random(0,99999999)
	-- end
	len = len or 6
	local s = ""
	local ran = math.random
	for i=1,len do
		local n = ran(1,#self)
		s = s..self:sub(n,n)
	end
	return s
end

function Taobao_Shop()
    openURL("http://shop63330911.taobao.com")
    mSleep(100)
    dialog("已跳转到淘宝店铺，脚本自动停止",3) 
    lua_exit()   
end

function Check_Data()
    m_initRandom(getDeviceID()) --根据设备码来重置随机种子
    u_id = getDeviceID() --获取设备ID
    local t = 0
    while true do
        time = os.time() --预防未获取到时间戳
        if time ~= nil or t == 3 then
            break
        end
        t = t + 1
    end
    if time == nil then
        dialog("无效的时间戳", 0)
        lua_exit()
    end
    rd_string = string.random("abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",16) --随便16位字符串
    s_number = 1 --脚本ID
    s_version = "1.0.0" --脚本版本号
    s_url = ""
    s_name = ""
end

function Up_Data()
    z_http("get", s_url, "/User/Media/TouchSprite/lua/"..s_name..".lua")
    dialog("您的脚本正在升级，请稍候……",2)
end

function Check_Key()
    Check_Data()
    ::Keyagain::
    cd_key = dialogInput("在线充值系统\r\n请输入 12 位充值卡卡号","12 位充值卡卡号","确认充值")
    if cd_key == "" then
        dialog("卡号不能为空，请重新输入",0)
        goto Keyagain
    end
    check_k = z_http("get","http://mc.82flex.com/api/add?uuid="..u_id.."&serial="..cd_key.."&t="..time.."&sid="..s_number.."&code="..rd_string)
    if string.byte(check_k) ~= 123 then
        dialog("无效的返回数据，请检查网络环境",0)
        lua_exit()
    end
    if check_k ~= "!HTTP GET ERROR" then
        tab_k = json2table(check_k) --json转table
    elseif check_k == "!HTTP GET ERROR" then
        dialog("当前无任何网络,请确认是否开启 WiFi 或 3G",0)
        lua_exit()
    end
    ks = tab_k['status'] --数组读取  
    if ks == 0 then
        dialog("充值成功！",0)
        Check_Uid()
    elseif ks == -1 then
        dialog("请求参数错误，错误代码：-1\r\n请联系卖家",0)
        lua_exit()
    elseif ks == -2 then
        dialog("服务器请求超时，错误代码：-2\r\n请联系卖家",0)
        lua_exit()
    elseif ks == -3 then
        dialog("请求参数长度不正确，错误代码：-3\r\n请联系卖家",0)
        lua_exit()
    elseif ks == -4 then
        dialog("服务器参数校验失败，错误代码：-4\r\n请联系卖家",0)
        lua_exit()
    elseif ks == -5 then
        dialog("充值失败，该卡号只能充值指定脚本，错误代码：-5",0)
        lua_exit()
    elseif ks == -6 then
        dialog("卡号已被使用，请重新输入。",0)
        goto Keyagain
    elseif ks == -7 then
        dialog("卡号无效，请重新输入。",0)
        goto Keyagain
    end
end

function Check_Uid()
    Check_Data()
    -- 获取服务器验证返回值
    check_s = z_http("get","http://mc.82flex.com/api/verify?uuid="..u_id.."&t="..time.."&sid="..s_number.."&code="..rd_string.."&version="..s_version)
    if string.byte(check_s) ~= 123 then
        dialog("无效的返回数据,请检查网络环境。",0)
        lua_exit()
    end
    if check_s ~= "!HTTP GET ERROR" then
        tab_s = json2table(check_s) --json转table
    elseif check_s == "!HTTP GET ERROR" then
        dialog("网络连接失败，请确认是否开启 WiFi 或 3G",0)
        lua_exit()
    end
    s = tab_s['status'] --数组读取
    --l = tab_s['lefttime']
    r = tab_s['role']
    ver = tab_s['version']
    if s >= 0 then
        v = tab_s['verify'] --数据校验
        if v ~= mkcode(rd_string) then
            dialog("数据校验失败,无法通过验证\r\n请联系卖家",0)
            lua_exit()
        end
        if s ~= 3 then
            f = tab_s['format']
            if f ~= nil then
                _f = utf8decode(f) --utf8
            else
                dialog("数据错误：无效的时间字符串\r\n请联系卖家",0)
                lua_exit()
            end
        end
    end
    if s == 1 and r == 0 then --指的是设备首次注册，开始试用
        s1 = dialogRet("当前设备第一次使用该脚本\r\n脚本剩余试用时间：".._f.."\r\n是否选择先试用？","试用","充值","购买",0) --0,1,2
        if s1 == 1 then
            Check_Key()
        elseif s1 == 2 then
            Taobao_Shop()
        end
    elseif r == 0 then --指的是试用期间
        r1 = dialogRet("脚本剩余试用时间：".._f.."\r\n是否选择继续试用？","试用","充值","购买",0) --0,1,2
        if r1 == 1 then
            Check_Key()
        elseif r1 == 2 then
            Taobao_Shop()
        end
    elseif s == 0 and r == 1 then --指的是设备非首次注册，校验正常
        s2 = dialogRet("脚本剩余使用时间：".._f,"确定","充值",0,8) --0,1,2
        if s2 == 1 then
            Check_Key()
        end
    elseif s == 2 then --指的是设备非首次注册，校验过期
        s3 = dialogRet("脚本使用时间已到期\r\n是否选择要充值？","关闭","充值","购买",0)
        if s3 == 1 then
            Check_Key()
        elseif s3 == 2 then
            Taobao_Shop()
        elseif s3 == 0 then
            lua_exit()
        end
    elseif s == 3 then --有新版本，需要更新
        s_url = string.gsub(utf8decode(tab_s['url']), '\\/', '/')
        s = tab_s['name']
        e = string.format("%.2f", tab_s['size'] / 1024)
        l = string.gsub(tab_s['logs'], '\\r\\n', '\r\n')
        if l ~= nil and s_url ~= nil and s ~= nil then
            _l = utf8decode(l) --utf8
            s_name = utf8decode(s) --utf8
        else
            dialog("更新数据不完整\r\n请联系卖家",0)
            lua_exit()
        end
        s4 = dialogRet(_l.."\r\n更新包大小："..e.." KB".."\r\n是否选择要更新？","关闭","更新","联系",0)
        if s4 == 1 then
            Up_Data()
            dialog("升级成功，当前版本号：V"..ver,3)
            dofile("/User/Media/TouchSprite/lua/"..s_name..".lua")
            lua_exit()
            Check_Uid()
        elseif s4 == 2 then
            Taobao_Shop()
        elseif s4 == 0 then
            lua_exit()
        end
    elseif s == -1 then
        dialog("请求参数错误，错误代码：-1\r\n请联系卖家",0)
        lua_exit()
    elseif s == -2 then
        dialog("服务器请求超时，错误代码：-2\r\n请联系卖家",0)
        lua_exit()
    elseif s == -3 then
        dialog("请求参数长度不正确，错误代码：-3\r\n请联系卖家",0)
        lua_exit()
    elseif s == -4 then
        dialog("服务器参数校验失败，错误代码：-4\r\n请联系卖家",0)
        lua_exit()
    elseif s == -5 then
        dialog("脚本编号不存在，错误代码：-5\r\n请联系卖家",0)
        lua_exit()
    elseif s == -6 then
        dialog("设备号注册失败，错误代码：-6\r\n请联系卖家",0)
        lua_exit()
    end
end

Check_Uid()
dialog("验证通过",0)
